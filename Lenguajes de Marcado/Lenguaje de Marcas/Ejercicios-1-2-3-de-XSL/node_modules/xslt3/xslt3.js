#!/usr/bin/env node
 (function(){var CommandLine$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$commandLineOptions=function(){function a(c,g="HE"){c.addRecognizedOption("co",b.TYPE_ENUMERATION|b.VALUE_REQUIRED,"Set compiler option");c.setPermittedValues("co","justStatic justNormalize noXPath noBindings timing traceProgress enableAssertions internalCompile".split(" "),null);c.addRecognizedOption("tp",b.TYPE_BOOLEAN,"Trace compiler progress");c.addRecognizedOption("export",b.TYPE_FILENAME|b.VALUE_REQUIRED,
"Export the compiled stylesheet");c.addRecognizedOption("im",b.TYPE_QNAME|b.VALUE_REQUIRED,"Name of initial mode");c.addRecognizedOption("it",b.TYPE_QNAME,"Name of initial template");c.setPermittedValues("it",[],"Q{http://www.w3.org/1999/XSL/Transform}initial-template");c.addRecognizedOption("json",b.TYPE_FILENAME|b.VALUE_REQUIRED,"Source file for primary JSON input");c.addRecognizedOption("master",b.TYPE_FILENAME|b.VALUE_REQUIRED,"Master document for in-situ update");c.addRecognizedOption("nogo",
b.TYPE_BOOLEAN,"Compile only, no evaluation");c.addRecognizedOption("ns",b.TYPE_ENUMERATION|b.VALUE_REQUIRED,"Default namespace for element names");c.setPermittedValues("ns",["##html5"],null);c.addRecognizedOption("o",b.TYPE_FILENAME|b.VALUE_REQUIRED,"Destination file for primary output");c.addRecognizedOption("relocate",b.TYPE_BOOLEAN,"Produce relocatable packages");c.addRecognizedOption("s",b.TYPE_FILENAME|b.VALUE_REQUIRED,"Source file for primary XML input");c.addRecognizedOption("t",b.TYPE_BOOLEAN,
"Display version and timing information, and names of output files");c.addRecognizedOption("xp",b.TYPE_STRING,"XPath expression");c.addRecognizedOption("xsl",b.TYPE_FILENAME,"Main stylesheet file (XSLT or SEF)");c.addRecognizedOption("?",b.TYPE_BOOLEAN|b.VALUE_PROHIBITED,"Display command line help text");"EE"===g&&(c.addRecognizedOption("debug",b.TYPE_BOOLEAN,"Use diagnostic version of SaxonJS 2"),c.addRecognizedOption("T",b.TYPE_ENUMERATION,"Trace execution"),c.setPermittedValues("T",["none","low",
"normal","high"],"low"),c.addRecognizedOption("TP",b.TYPE_FILENAME|b.VALUE_REQUIRED,"Write timing profile to specified output file"))}const b={TYPE_BOOLEAN:1,TYPE_FILENAME:2,TYPE_ENUMERATION:4,TYPE_INTEGER:5,TYPE_QNAME:6,TYPE_FILENAME_LIST:7,TYPE_DATETIME:8,TYPE_STRING:9,TYPE_INTEGER_PAIR:10,VALUE_REQUIRED:256,VALUE_PROHIBITED:512},d=["on","yes","true","1"],h=["off","no","false","0"];let e={TYPE_BOOLEAN:d.concat(h).join("|"),TYPE_FILENAME:"file name",TYPE_ENUMERATION:4,TYPE_INTEGER:"integer",TYPE_QNAME:"QName in URI qualified name form (Q{uri}local)",
TYPE_FILENAME_LIST:"list of file names, semicolon-separated",TYPE_DATETIME:"dateTime in ??? format",TYPE_STRING:"string",TYPE_INTEGER_PAIR:"int,int"};for(let c in b)e[b[c]]=e[c];class f{constructor(){this._recognized={};this.actualOptions={};this.extraOptions={}}addRecognizedOption(c,g,l){this._recognized[c]={type:g&255,required:g&768,help:l}}setPermittedValues(c,g,l){let r=this._recognized[c];r?(r.values=g,r.defaultValue=l):console.log("setPermittedValues - no record yet for option:",c)}displayPermittedOptions(){let c=
[];for(let g in this._recognized)c.push(g);c.sort((g,l)=>{g=g.toLowerCase();l=l.toLowerCase();return g<l?-1:g===l?0:1});c=c.map(g=>" -"+g);return c.join()}setActualOptions(c){function g(m,k){throw Error("Command line option -"+m+" "+k);}const l=this._recognized;let r=this.actualOptions,t=this.extraOptions;c.filter(m=>m.startsWith("-")).forEach(function(m){var k=m.indexOf(":"),n=0>k?m.substring(1):m.substring(1,k);k=0>k?"":m.substring(k+1);if(m.startsWith("--"))t[n.substring(1)]=k;else{(m=l[n])||g(n,
"is not recognized");if("?"===k)throw n="Help for -"+n+" option:\nValue:   "+(4==m.type?m.values.join("|"):e[m.type]),n+="\nMeaning: "+m.help,Error(n+"\n\nNo processing requested");256===m.required&&""===k&&g(n,"requires a value");512===m.required&&""!==k&&g(n,"must not have a value");""===k&&(k=m.defaultValue||"");switch(m.type){case 4:k&&-1===m.values.indexOf(k)&&g(n,"may only have values "+m.values.join("|"));break;case 5:/[0-9]+/.test(k)||g(n,"may only have value "+e.TYPE_INTEGER);k=parseInt(k,
10);break;case 1:0<=d.indexOf(k)?k=!0:0<=h.indexOf(k)?k=!1:""===k?k=!0:g(n,"may only have a boolean value "+e.TYPE_BOOLEAN);break;case 6:/{/.test(k)||/}/.test(k)||(k="Q{}"+k),/^Q{[^{}]*}[^{}]+$/.test(k)||g(n,"may only have value "+e.TYPE_QNAME)}r[n]=k}})}}return{OptionTypes:b,newCLOptions:function(c="HE"){let g=new f;a(g,c);return g}}}(),module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$commandLineOptions={};
module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$commandLineOptions.CommandLine=CommandLine$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$commandLineOptions;const argv$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=process.argv;let finished$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=!1,exitCode$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=0,failed$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=!1,profiler$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command;
function exit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a=0){finished$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=!0;a>exitCode$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command&&(exitCode$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=a,process.exitCode=a)}
function quit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a,b=0){console.error(a);failed$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=!0;exit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(b)}
function log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.saxonPrint(a)}function warn$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("*Warning*: "+a)}
function staticExceptionMessage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){return a instanceof SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XError?"Error "+a.code.replace(/^Q\{http:\/\/www.w3.org\/2005\/xqt-errors\}/,"")+(a.errorObject?a.errorObject.toString():"")+":\n  "+a.message:a.hasOwnProperty("message")?a.message:a.toString()}
function exceptionMessage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){return a instanceof SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XError?a.getMessage():a.hasOwnProperty("message")?a.message:a.toString()}
function hasArg$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){return argv$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.includes(a)}const fs$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=require("fs"),{URL:URL$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command}=require("url");
let extensions$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command={getTraceCodeInjector:function(){return null},getProfiler:function(){return null},registerExtensions:function(){}};"undefined"!==typeof Extensions&&(extensions$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=Extensions);let RenderProfileSEF$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command={};
"undefined"!==typeof RenderProfile&&(RenderProfileSEF$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=RenderProfile.sef);let edition$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command={getSaxonEdition:function(){return"HE"}};"undefined"!==typeof Edition&&(edition$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=Edition);
let SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=null;SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command="EE"===edition$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.getSaxonEdition()?require(hasArg$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("-debug")?"./SaxonJS2N.debug.js":"saxon-js"):require("saxon-js");
const platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.getPlatform();
function getParamsMap$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){const b={};a.filter(d=>!/^[-!]/.test(d)).forEach(function(d){const h=d.split("=");let [e,f]=h;1===h.length&&quit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Missing '=' in parameter '"+d+"'",2);switch(e.charAt(0)){case "?":e=e.slice(1);try{f=SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XPath.evaluate(f,
null,{resultForm:"xdm"})}catch(c){throw c;}break;case "+":e=e.slice(1),f=getPathToFileSync$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(f),fs$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.statSync(f).isDirectory()?quit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(f+" is a directory",2):f=[getXML$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(f)]}/{/.test(e)||
/}/.test(e)||(e="Q{}"+e);/^Q{[^{}]*}[^{}]+$/.test(e)||quit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Invalid parameter key "+e,2);b[e]=f});return b}
function getXdmParams$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){const b=new SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XdmMap;for(const d in a){let h=a[d];Array.isArray(h)||(h=[SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XS.untypedAtomic.fromString(h)]);b.inSituPut(SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XS.QName.fromEQName(d),
h)}return b}function getSerializationParams$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){const b={};a.filter(d=>d.startsWith("!")).forEach(function(d){d=d.split(/=/);let [h,e]=d;h=h.slice(1).replace(/^saxon:/,"Q{http://saxon.sf.net/}");b[h]=SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.Serializer.validateParam(h,e)});return b}
function addParentPointers$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){a.C&&a.C.forEach(function(b){b.parentNode=a;addParentPointers$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(b)})}
function checksum$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){function b(c,g){g<<=8;for(let l=0;l<c.length;l++)g=(g<<1)+c.charCodeAt(l);return g}function d(c,g,l){return b(c,l)^b(g,l)}function h(c){e^=d(c.N,"http://ns.saxonica.com/xslt/export",f++);for(let g in c)c.hasOwnProperty(g)&&"N"!==g&&"C"!==g&&g!==String.fromCharCode(931)&&(e^=d(g,"",f),e^=b(c[g],f));c.C&&c.C.forEach(function(g){h(g)});e^=1}let e=0,f=0;h(a);a[String.fromCharCode(931)]=(0>e?4294967295+
e+1:e).toString(16)}function TransformOptions$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(){}TransformOptions$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.prototype={stylesheetParams:{},templateParams:{},tunnelParams:{},functionParams:{},deliverResultDocument:void 0,stylesheetText:""};
function invokeSEFTransform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a,b,d){d.async=!0;const h=SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.checkOptions(d);return b?SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.getResource({file:b,type:"xml"}).catch(e=>Promise.reject(e)).then(e=>{SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.internalTransform(a,
e,h);return h.resultPromise}):Promise.reject(Error("Source filename missing"))}
function compileXSLT$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a,b,d){let h=new TransformOptions$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command;h.destination="application";h.initialMode="compile-complete";h.templateParams={"Q{}options":{noXPath:!1}};for(let e in b)b.hasOwnProperty(e)&&(h.templateParams["Q{}options"][e]=b[e]);h.stylesheetParams=new SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XdmMap;
h.stylesheetParams.inSituPut(SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XS.QName.fromParts("","","staticParameters"),[d]);b=platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.resource("compiler");addParentPointers$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(b);h.stylesheetInternal=b;return invokeSEFTransform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(b,
a,h).then(e=>e.principalResult)}function getXML$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){const b=platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.parseXmlFromString(readFile$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a));b._saxonBaseUri=filepathToUri$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a);return b}
function readFile$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){try{return fs$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.readFileSync(a,"utf8")}catch(b){quit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Unable to read "+a,2)}}
function getPathToFileSync$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){return fs$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.realpathSync(a)}function getPathToFile$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){return fs$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.promises.realpath(a)}
function filepathToUri$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){return platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.fileURL(a)}
function compile$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a,b,d,h,e){return getPathToFile$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a.xsl).catch(f=>{f=f.message.replace("ENOENT: no such file or directory, realpath ","");return Promise.reject(new SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XError("Cannot locate stylesheet ("+f+")"))}).then(f=>{if(f.endsWith(".sef")||
f.endsWith(".sef.json"))return d.stylesheetFileName=f,d;if(f.endsWith(".sef.xml")){let c,g=getXML$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(f);try{c=SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XPath.sefToJSON(g.firstChild,!1)}catch(l){return Promise.reject(Error("Internal error: the intermediate XML form of the SEF file is invalid: "+l.message))}checksum$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(c);
d.stylesheetText=JSON.stringify(c);return d}a.t&&console.error("Compiling stylesheet "+f);return compileXSLT$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(f,b,h).catch(c=>{console.error(staticExceptionMessage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(c));return Promise.reject(Error("Failed to compile stylesheet"))}).then(c=>{Array.isArray(c)&&(c=c[0]);let g;try{g=SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XPath.sefToJSON(c.firstChild,
!1)}catch(l){return Promise.reject(Error("Internal error: the intermediate XML form of the SEF file is invalid: "+l.message))}checksum$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(g);d.stylesheetText=JSON.stringify(g);d.stylesheetBaseURI=filepathToUri$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(f);return d})})}
function executeTransformation$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a,b,d){const h=process.hrtime();if(a.o){var e=a.o;try{fs$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.realpathSync(e)}catch(f){platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.writeFileSync(new URL$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(filepathToUri$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(e)),
"")}b.baseOutputURI=filepathToUri$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(e);b.destination="file"}else b.destination="stdout",b.baseOutputURI=platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.baseURL();d&&(b.logLevel=2);a.T&&(b.traceInjector=extensions$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.getTraceCodeInjector(SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command,
a.T));a.TP&&(profiler$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command=extensions$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.getProfiler(SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command),b.traceInjector=profiler$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.injector);a.s&&(e=a.s,/^(http:|https:|file:)/.test(e)?b.sourceLocation=e:b.sourceFileName=
filepathToUri$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(e).toString());a.json&&(a.s&&quit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Cannot supply both -s and -json",2),e=a.json,/^(http:|https:|file:)/.test(e)?b.sourceLocation=e:b.sourceFileName=filepathToUri$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(e).toString(),b.sourceType="json");a.it&&(d&&log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Initial template: "+
a.it),b.initialTemplate=a.it);a.im&&(d&&log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Initial mode: "+a.im),b.initialMode=a.im);d&&a.o&&log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Writing to "+filepathToUri$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a.o));return SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.transform(b,"async").then(()=>
{if(d){var f=process.hrtime(h);console.warn("\nExecution time: %d.%ds",f[0],Math.floor(f[1]/1E6));f=process.memoryUsage().heapUsed/1024/1024;console.warn(`Memory used: ${Math.round(100*f)/100}Mb`)}})}
function main$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(){var a=argv$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.slice(2);let b=CommandLine$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$commandLineOptions.newCLOptions(edition$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.getSaxonEdition());try{b.setActualOptions(a)}catch(f){quit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(exceptionMessage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(f),
2)}if(!finished$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command&&!failed$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command){var d=b.actualOptions,h=b.extraOptions,e=new TransformOptions$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command;a.forEach(f=>{finished$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command||/[=-]/g.test(f)||badUsage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Invalid command line input: "+
f)});if(!finished$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command)try{const f=getParamsMap$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a),c=getSerializationParams$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a),g=31536E6<Date.now()-Date.parse(SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.getProcessorInfo().releaseDate);if(d["?"])badUsage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("");
else{const l=d.t,r=d.ns,t=d.relocate,m=d.tp,k=d.co;if(l||g){const n=SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.getProcessorInfo();log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(n.productName+" "+n.productVersion+" from Saxonica "+(g?" (*** NO LONGER SUPPORTED ***)":""));log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Node.js version "+process.version)}if(d.xsl||d.xp)if(extensions$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.registerExtensions(SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command),
d.xsl){const n=getXdmParams$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(f);a={traceProgress:!!m,timing:!!l};a.extraOptions=h;a.relocatable=!!t;r&&(a.ns=r);k&&(a[k]=!0);let u=compile$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(d,a,e,n,c);d["export"]&&(u=u.then(p=>platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.writeFileAsync(new URL$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(filepathToUri$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(d["export"])),
p.stylesheetText,"utf8")).then(()=>getPathToFile$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(d["export"]).then(p=>{l&&log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Stylesheet exported to SEF file "+p)})));let q=u.then(()=>{d.nogo&&exit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command()});if(!d.nogo){if(d.master)try{const p=platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.readFile(d.master),
v=platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.parseXmlFromString(p);e.masterDocument=v}catch(p){return log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Failed while reading and parsing master document "+d.master),Promise.reject(p)}q=q.then(()=>{e.stylesheetParams=n;e.outputProperties=c;e.extraOptions=h;return executeTransformation$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(d,
e,l)}).then(()=>{l&&!failed$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command&&log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Transformation complete ")})}q=q.catch(p=>quit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(exceptionMessage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(p),2));e.masterDocument&&(q=q.then(()=>{if(failed$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command)return Promise.reject("Transformation failed");
const p=SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.serialize(e.masterDocument,{method:"xml"});return fs$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.promises.writeFile(d.master,p)}));d.TP&&(q=q.then(()=>{const p=d.TP,v=profiler$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.report();return SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.transform({stylesheetText:JSON.stringify(RenderProfileSEF$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command),
stylesheetParams:{"Q{}metrics":JSON.stringify(v)},destination:"file",baseOutputURI:filepathToUri$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(p),outputProps:{method:"html",indent:!0}},"async").catch(w=>Promise.reject(w))}).catch(p=>Promise.reject(p)));q.finally(()=>{exit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command()}).catch(p=>{quit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(exceptionMessage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(p),
1)})}else executeXPath$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(d,f,c),exit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command();else quit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Saxon requires a stylesheet as -xsl: argument",2)}}catch(f){quit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(exceptionMessage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(f),
2)}}}
function executeXPath$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a,b,d){if("s"in a||"json"in a){const h=a.s||a.json;let e={};/^(http:|https:|file:)/.test(h)?e.location=h:e.file=h;platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.resourcePromise(e).then(f=>{f="s"in a?platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.parseXmlFromString(f):platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.parseJsonFromString(f);executeXPathOverData$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(f,
a,b,d)}).catch(f=>{console.error(exceptionMessage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(f));exit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(1)})}else try{executeXPathOverData$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(null,a,b,d)}catch(h){console.error(exceptionMessage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(h)),exit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(1)}}
function executeXPathOverData$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a,b,d,h){const e=platform$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.baseURL();a=SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.XPath.evaluate(b.xp,a,{resultForm:"xdm",params:d,staticBaseURI:e});d={method:"adaptive"};for(const f in h)d[f]=h[f];h=SaxonJS$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.serialize(a,
d);"o"in b?(b=fs$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.openSync(b.o,"w"),fs$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.writeSync(b,h,0,"utf-8"),fs$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command.closeSync(b)):process.stdout.write(h)}
function badUsage$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(a){""!==a&&console.error(a);log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Usage: see http://www.saxonica.com/saxon-js/documentation/index.html#!nodejs/command-line");let b=CommandLine$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$commandLineOptions.newCLOptions();log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Options available:"+
b.displayPermittedOptions());log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Use -XYZ:? for details of option XYZ");log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("Params: ");log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("  param=value           Set stylesheet string parameter");log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("  +param=filename       Set stylesheet document parameter");
log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("  ?param=expression     Set stylesheet parameter using XPath");log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("  !param=value          Set serialization parameter");log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command("  (bindings and values containing punctuation may need to be quoted in some command shells,");log$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command('   e.g. in PowerShell:  "{NS}key=val" ?range="1 to 20" )');
""===a?exit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command():exit$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command(2)}main$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command();(function wait(){finished$$module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command||setTimeout(wait,100)})();
var module$Volumes$Saxonica$src$saxonica$saxon_js_enterprise$src$main$js$nodeJS$command={};}).call(this);

